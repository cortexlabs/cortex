- kind: environment
  name: dev
  data:
    type: csv
    path: s3a://cortex-examples/movie-ratings.csv
    csv_config:
      header: true
    schema: [@user_id, @movie_id, @rating, @timestamp]

- kind: raw_column
  name: user_id
  type: STRING_COLUMN

- kind: raw_column
  name: movie_id
  type: STRING_COLUMN

- kind: raw_column
  name: rating
  type: FLOAT_COLUMN

- kind: aggregate
  name: user_id_index
  aggregator: cortex.index_string
  input: @user_id

- kind: transformed_column
  name: user_id_indexed
  transformer: cortex.index_string
  input:
    col: @user_id
    indexes: @user_id_index

- kind: aggregate
  name: movie_id_index
  aggregator: cortex.index_string
  input: @movie_id

- kind: transformed_column
  name: movie_id_indexed
  transformer: cortex.index_string
  input:
    col: @movie_id
    indexes: @movie_id_index
