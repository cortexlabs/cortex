- kind: environment
  name: dev
  log_level:
    spark: INFO
  data:
    type: csv
    path: s3a://cortex-examples/reviews.csv
    csv_config:
      header: true
      escape: "\""
    schema: [@review, @label]

- kind: aggregate
  name: max_review_length
  aggregator_path: implementations/aggregators/max_length.py
  input: @review

- kind: aggregate
  name: reviews_vocab
  aggregator_path: implementations/aggregators/vocab.py
  input:
    col: @review
    vocab_size: 10000

- kind: aggregate
  name: label_index
  aggregator: cortex.index_string
  input: @label

- kind: transformed_column
  name: embedding_input
  transformer_path: implementations/transformers/tokenize_string_to_int.py
  input:
      col: @review
      max_len: @max_review_length
      vocab: @reviews_vocab

- kind: transformed_column
  name: label_indexed
  transformer: cortex.index_string
  input:
    col: @label
    indexes: @label_index
