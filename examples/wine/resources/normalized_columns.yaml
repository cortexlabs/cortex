- kind: template
  name: normalize
  yaml: |
    - kind: aggregate
      name: {column}_mean
      aggregator: cortex.mean
      input: @{column}

    - kind: aggregate
      name: {column}_stddev
      aggregator: cortex.stddev
      input: @{column}

    - kind: transformed_column
      name: {column}_normalized
      transformer: cortex.normalize
      input:
        col: @{column}
        mean: @{column}_mean
        stddev: @{column}_stddev

- kind: embed
  template: normalize
  args:
    column: fixed_acidity

- kind: embed
  template: normalize
  args:
    column: volatile_acidity

- kind: embed
  template: normalize
  args:
    column: citric_acid

- kind: embed
  template: normalize
  args:
    column: residual_sugar

- kind: embed
  template: normalize
  args:
    column: chlorides

- kind: embed
  template: normalize
  args:
    column: free_sulfur_dioxide

- kind: embed
  template: normalize
  args:
    column: total_sulfur_dioxide

- kind: embed
  template: normalize
  args:
    column: density

- kind: embed
  template: normalize
  args:
    column: pH

- kind: embed
  template: normalize
  args:
    column: sulphates

- kind: embed
  template: normalize
  args:
    column: alcohol

- kind: embed
  template: normalize
  args:
    column: quality
